**Важные метрики покрытия** подробно и структурно. Эти метрики часто **важнее, чем покрытие кода**, так как они фокусируются на требованиях, пользователе и рисках — то есть на том, *что* и *почему* мы тестируем.

---

### 1. Покрытие требований (Requirements Coverage)
**Суть:** Насколько полно тестовый набор проверяет все формальные требования к системе. Это связь между миром разработки и миром бизнеса.

**Как измеряется:**
*   **Метрика:** `(Количество проверенных требований / Общее количество требований) * 100%`.
*   **Механика:** Каждому тест-кейсу или автотесту ставится в соответствие одно или несколько **идентификаторов требований** (например, `REQ-1.2`, `FUNC-USER-LOGIN`). В системах управления тестированием (TestRail, Qase, Zephyr) или ALM-системах (Jira + плагины) строится матрица прослеживаемости (Traceability Matrix), которая наглядно показывает, какие требования покрыты тестами, а какие — нет.

**Пример:**
> **Требование REQ-5:** *"Пользователь может восстановить пароль, указав email. На указанный email должно прийти письмо со ссылкой для сброса".*
> **Тесты:** `TC-101: Восстановление с валидным email`, `TC-102: Восстановление с невалидным email`, `TC-103: Проверка формата письма`.
> **Покрытие:** Требование REQ-5 покрыто тремя тестами.

**Плюсы:**
*   **Доказуемость:** Легко продемонстрировать заказчику или аудитору, что все оговоренные функции проверены.
*   **Фокус на цели:** Не позволяет "забыть" протестировать какую-то обязательную функцию.
*   **Основа для приемочного тестирования (UAT).**

**Минусы:**
*   **Качество требований:** Если требования написаны размыто или неполно, метрика теряет смысл.
*   **"Коробочное" мышление:** Может упустить сценарии, не описанные явно в требованиях, но очевидные с точки зрения пользователя.

---

### 2. Покрытие сценариев использования / Пользовательских историй (Use Case / User Story Coverage)
**Суть:** Оценка того, насколько полно протестированы ключевые пути взаимодействия пользователя с системой. Это переход от "проверки функций" к "проверке поведения".

**Как измеряется:**
*   Для каждого **Use Case** (с основным и альтернативными потоками) или **User Story** создается набор **сквозных (end-to-end) тестов** или интеграционных тестов.
*   **Метрика:** Покрытие можно оценивать качественно (все основные потоки покрыты) или количественно (например, % завершенных сценариев от запланированных к тестированию).
*   **Подход:** Составляется карта пользовательских путешествий (User Journey Map), и для каждого шага на карте определяется наличие тестов.

**Пример (User Story):**
> *"Как зарегистрированный пользователь, я хочу добавить товар в корзину, чтобы потом его купить".*
> **Сценарии для покрытия:**
> 1.  Добавление товара из каталога.
> 2.  Добавление товара со страницы товара.
> 3.  Добавление нескольких единиц одного товара.
> 4.  Проверка, что корзина обновляется без перезагрузки страницы (если заявлено).
> 5.  Добавление товара, которого нет в наличии (обработка ошибки).

**Плюсы:**
*   **Ориентация на ценность:** Тестируется то, что реально важно для пользователя.
*   **Выявление проблем интеграции:** Сквозные сценарии лучше всего ловят баги на стыке модулей.
*   **Основа для регрессионного тестирования критичного функционала.**

**Минусы:**
*   **Сложность поддержки:** Сквозные тесты (особенно UI) хрупкие и медленные.
*   **Неполнота:** Охватить все возможные вариации сценариев невозможно.

---

### 3. Покрытие данных (Data Coverage)
**Суть:** Оценка того, насколько разнообразны и репрезентативны тестовые данные. Код может быть покрыт на 100%, но работать неправильно на определенных данных.

**Как измеряется:**
*   **Классы эквивалентности и граничные значения:** Метрикой служит количество протестированных классов/границ. Например, для поля "Возраст" (18-99) нужно проверить: 17 (невалидная граница), 18, 19 (валидные границы), 50 (срединное значение), 99, 100 (невалидная граница).
*   **Комбинаторное покрытие:** Используются техники вроде **Pairwise (парное тестирование)**, чтобы покрыть наиболее вероятные комбинации входных параметров.
*   **Покрытие состояний данных:** Тестирование того, как система ведет себя с данными в разных состояниях (новые, обработанные, архивные, удаленные).

**Пример (Комбинаторное покрытие):**
> Форма с тремя полями: **Тип доставки** (Курьер, Самовывоз), **Оплата** (Карта, Наличные), **Срочность** (Стандарт, Экспресс).
> Полный перебор — 2x2x2 = 8 тестов. **Pairwise** подберет оптимальный набор (обычно 4-5 тестов), где каждая пара значений (Курьер-Карта, Курьер-Стандарт и т.д.) встретится хотя бы раз.

**Плюсы:**
*   **Эффективность:** Позволяет найти баги, связанные со специфичными данными, при меньшем количестве тестов.
*   **Систематичность:** Заставляет задуматься о разнообразии входных данных, а не писать тесты "на однотипных данных".

**Минусы:**
*   **Сложность генерации:** Требует навыков и иногда специальных инструментов для создания данных и комбинаций.
*   **Рост объема:** Полное покрытие всех комбинаций данных (как и путей) часто невозможно.

---

### 4. Покрытие рисков (Risk Coverage)
**Суть:** Самый стратегический вид покрытия. Оценка того, насколько тестовые усилия сконцентрированы на самых критичных для бизнеса и наиболее "багоопасных" областях системы.

**Как измеряется:**
1.  **Проводится анализ рисков:** Совместно с бизнес-аналитиками, архитекторами и разработчиками составляется **матрица рисков**.
2.  **Ранжирование:** Каждому модулю/функции присваивается приоритет на основе двух критериев:
    *   **Вероятность** дефекта (сложность, изменения в коде, компетенция разработчика).
    *   **Влияние** дефекта на бизнес (финансовые потери, репутационные риски, безопасность).
3.  **Распределение ресурсов:** На модули с **высокой вероятностью и высоким влиянием** выделяется больше всего тестовых ресурсов (время, глуби тестирования, виды тестирования).
4.  **Метрика:** Отчет о том, какой процент тестового времени/кейсов был потрачен на модули с высоким/средним/низким риском. Цель — чтобы **высокорисковые модули были протестированы наиболее тщательно**.

**Пример (Матрица рисков):**
| Модуль | Вероятность (1-3) | Влияние (1-3) | Уровень риска (В*В) | Стратегия тестирования |
| :--- | :---: | :---: | :---: | :--- |
| **Оплата транзакций** | 3 (сложная логика) | 3 (потеря денег) | **9 (КРИТИЧЕСКИЙ)** | Глубокое тестирование (MC/DC), нагрузочное, безопасность |
| **Каталог товаров** | 2 (часто меняется) | 2 (плохой UX) | **4 (СРЕДНИЙ)** | Регрессия, проверка UI |
| **Страница "О компании"** | 1 (стабильна) | 1 (опечатка) | **1 (НИЗКИЙ)** | Санти-чек или не тестируется |

**Плюсы:**
*   **Максимизация ROI тестирования:** Фокус на том, что важнее всего.
*   **Обоснованность решений:** Можно аргументировать, почему на одни модули пишут 100 автотестов, а на другие — 10.
*   **Превентивность:** Помогает выявить рискованные зоны до начала тестирования.

**Минусы:**
*   **Субъективность:** Оценка вероятности и влияния может быть субъективной.
*   **Требует экспертизы:** Нужно глубокое понимание продукта и бизнеса.

---

### 5. Покрытие среды/конфигураций (Environment/Configuration Coverage)
**Суть:** Актуально для кроссплатформенных и десктопных приложений. Оценка того, насколько приложение протестировано на всех заявленных платформах, браузерах, устройствах, версиях ОС, разрешениях экранов и конфигурациях.

**Как измеряется:**
*   **Матрица конфигураций:** Составляется таблица поддерживаемых окружений.
*   **Метрика:** `(Протестированные конфигурации / Все необходимые конфигурации) * 100%`.
*   **Практика:** Критические сценарии (логин, оплата) должны быть покрыты на всех основных конфигурациях. Менее важные — на репрезентативной выборке.

**Пример (Веб-приложение):**
> **Цель:** Покрытие 100% для Chrome, Firefox, Safari последних двух версий на Windows, macOS, iOS, Android.
> **Реальность:** 80% тестов на Chrome + Windows (основная среда), ключевые сценарии — на всех комбинациях из матрицы.

**Плюсы:** Гарантия, что продукт будет работать у конечных пользователей.
**Минусы:** Огромные трудозатраты. Решается через **автоматизацию на Selenium Grid/BrowserStack/Sauce Labs** и стратегию разумной достаточности.

### **Как это все работает вместе? Стратегический взгляд**

Идеальный подход — **комбинация метрик**:
1.  **На основе анализа рисков** определяем, **что** тестировать интенсивнее.
2.  **Покрытие требований** гарантирует, что мы ничего не упустили из контракта.
3.  **Покрытие сценариев использования** обеспечивает проверку работоспособности продукта с точки зрения пользователя.
4.  **Покрытие данных** и **кода** (ветвей) дает глубину проверки внутри каждого модуля.
5.  **Покрытие конфигураций** подтверждает работу на всех необходимых платформах.

Таким образом, **покрытие кода (например, ветвей) — это тактическая, низкоуровневая метрика.** А **покрытие требований, рисков и сценариев — это стратегические, бизнес-ориентированные метрики**, которые должны быть первичны при планировании тестирования.

___________________________________________
_________________________________________

Для оценки результатов работы группы тестирования используют
метрики покрытия (Coverage criteria) или полноты. Метрики покрытия позволяют оценить охват объекта тестирования тестами и выявить слабые места, где покрытие тестами минимально. Для оценки
покрытия можно воспользоваться следующими метриками.

