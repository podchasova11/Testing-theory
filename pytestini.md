`pytest.ini` — это конфигурационный файл для инструмента тестирования `pytest`, который используется для настройки поведения тестов в вашем проекте. Он позволяет задать различные параметры и настройки, что упрощает запуск тестов и управление ими. 

Вот некоторые из основных возможностей, которые предоставляет `pytest.ini`:

1. **Настройка параметров**: Вы можете указать параметры командной строки, такие как уровень логирования, директории для поиска тестов и т. д.

2. **Исключения**: Настройка, чтобы игнорировать определенные файлы или директории.

3. **Плагины**: Указание плагинов, которые должны быть загружены вместе с `pytest`.

4. **Общие опции**: Определение общих опций для тестов, таких как `addopts`, что может включать дополнительные параметры для запуска.

Пример содержимого `pytest.ini`:

```ini
[pytest]
addopts = -v --tb=short
testpaths = tests
```
___________________________
в `pytest.ini` можно прописывать настройки для использования маркировок (markers) в тестах с помощью секции `[pytest]`. Это позволяет вам фиксировать пользовательские маркировки и предупреждать `pytest` о их использовании. Например, если у вас есть кастомная маркировка `slow`, вы можете определить её следующим образом:

```ini
[pytest]
markers =
    slow: mark test as slow
    smoke: mark test as smoke test
```

С помощью этого описания вы сможете использовать маркировки в ваших тестах, например:

```python
import pytest

@pytest.mark.slow
def test_slow_case():
    assert True

@pytest.mark.smoke
def test_smoke_case():
    assert True
```

Также важно помнить, что после добавления пользовательских маркировок в `pytest.ini`, это позволит делать более удобные отчеты о тестах и лучше организовать их выполнение на основе маркировки. 
______________________________________________

Давайте подробнее рассмотрим, как использовать маркировки (markers) в `pytest`, включая их определение и применение в тестах.

### Что такое маркировки в `pytest`?

Маркировки — это способ пометить тестовые функции или классы в `pytest`, чтобы затем можно было управлять их выполнением. Это полезно для группировки тестов, задания определенных категорий или пометки тестов с особыми условиями, такими как временные, медленные или требующие особых ресурсов.

### Определение маркировок в `pytest.ini`

Для начала, вам нужно создать или отредактировать файл `pytest.ini`, который находится в корне вашего проекта. Внутри этого файла вы можете определить свои пользовательские маркировки. 

Пример `pytest.ini`:

```ini
[pytest]
markers =
    slow: mark test as slow
    smoke: mark test as smoke test
    dependency: mark test with dependency on another test
```

#### Как это работает

- **Метка `slow`**: Вы можете пометить тесты, которые выполняются долго, чтобы в дальнейшем запускать их только при необходимости или для выборочного тестирования.
- **Метка `smoke`**: Используется для обозначения основных тестов, которые проверяют основные функции приложения.
- **Метка `dependency`**: Позволяет вам указывать, что один тест зависит от выполнения другого.

### Применение маркировок в тестах

Теперь, когда вы определили маркировки, вы можете использовать их в ваших тестовых функциях или классах.

Пример тестового файла `test_example.py`:

```python
import pytest

@pytest.mark.slow
def test_slow_case():
    import time
    time.sleep(5)  # Имитация долгого теста
    assert True

@pytest.mark.smoke
def test_smoke_case():
    assert True

@pytest.mark.dependency
def test_dependent_case(test_slow_case):
    assert True  # Зависит от test_slow_case
```

### Запуск тестов с учетом маркировок

Теперь, когда у вас есть тесты с маркировками, вы можете запускать их по группам. Например, если вы хотите запустить только «медленные» тесты, вы можете использовать следующую команду:

```bash
pytest -m slow
```

Если вы хотите запустить «дымовые» тесты, используйте:

```bash
pytest -m smoke
```

Можно также комбинировать маркировки. Например, если вы хотите запустить все тесты, кроме «медленных», вы можете сделать это так:

```bash
pytest -m "not slow"
```

### Почему стоит использовать маркировки?

1. **Организация**: Легче управлять большим количеством тестов, разделяя их по категориям.
2. **Гибкость**: Вы можете запускать только те тесты, которые хотите протестировать в данный момент, что экономит время и ресурсы.
3. **Ясность**: Сделает ваше тестовое окружение более понятным для других разработчиков, поскольку будет ясно, какие тесты чем помечены.

### Заключение

Использование маркировок в `pytest` делает процесс тестирования более организованным и управляемым. Позволяя вам фокусироваться на конкретных аспектах вашего кода, они помогают улучшить качество ваших тестов и их выполнение.

_____________________________________
Давайте разберем `pytest.ini` более подробно, с примерами для каждой возможности, позволяющей настроить `pytest` под ваши нужды.

### Что такое `pytest.ini`?

`pytest.ini` — это конфигурационный файл, который позволяет задавать настройки для тестирования с использованием фреймворка `pytest`. Этот файл находится в корневом каталоге вашего проекта и позволяет управлять различными аспектами выполнения тестов.

### Основные возможности `pytest.ini`

#### 1. Настройка параметров

Вы можете задать параметры, которые обычно передаются в командной строке, прямо в `pytest.ini`. Это позволяет избежать необходимости указывать их каждый раз при запуске тестов.

**Пример:**

```ini
[pytest]
addopts = -v --tb=short
```

- **`-v`**: Включает "подробный" режим, который выводит более детальную информацию о запущенных тестах.
- **`--tb=short`**: Указывает, что трассировка ошибок (traceback) должна быть короткой, что делает вывод более чистым.

Теперь, даже если вы не введете эти параметры при запуске `pytest`, они будут применяться автоматически.

#### 2. Исключения

Вы можете указать, какие файлы или директории `pytest` должен игнорировать во время поиска тестов.

**Пример:**

```ini
[pytest]
norecursedirs = .git venv
```

В этом примере `pytest` будет игнорировать директории `.git` и `venv` при рекурсивном поиске тестов. Это полезно, чтобы избежать случайного запуска тестов из папок с версиями или виртуальными окружениями.

#### 3. Плагины

`pytest` поддерживает множество плагинов, которые могут расширять его функциональность. Вы можете указать, какие плагины нужно загружать в `pytest.ini`.

**Пример:**

```ini
[pytest]
plugins = pytest-cov
```

Этот пример загружает плагин `pytest-cov`, который используется для создания отчётов о покрытии кода тестами.

#### 4. Общие опции

Вы можете задавать общие опции, которые будут применяться ко всем тестам. Это особенно полезно для настройки определенных параметров, не привязывая их к конкретным тестам.

**Пример:**

```ini
[pytest]
addopts = -v --tb=short
testpaths = tests
```

- **`testpaths = tests`**: Указывает директорию, в которой `pytest` будет искать тесты. В данном случае это директория `tests`.

### Пример структуры проекта с `pytest.ini`

Рассмотрим пример проекта, чтобы увидеть, как может выглядеть структура каталогов и как будет использоваться `pytest.ini`.

```
my_project/
│
├── tests/
│   ├── test_example.py
│   └── test_another.py
│
├── .git/
│
├── venv/
│
└── pytest.ini
```

### Пример `test_example.py`

Давайте добавим несколько тестов в файл `test_example.py`:

```python
# tests/test_example.py
def test_add():
    assert 1 + 1 == 2

def test_subtract():
    assert 2 - 1 == 1
```

### Запуск тестов

Теперь, когда у нас есть настроенный `pytest.ini` и тесты, мы можем запустить тесты простым вводом команды в терминале:

```bash
pytest
```

С учетом настроек в `pytest.ini`, будет выполнен поиск тестов в директории `tests`, и будет использован указанный формат вывода.

### Вывод

Таким образом, `pytest.ini` помогает упростить конфигурацию вашего тестового окружения, позволяя вам задавать параметры, игнорировать нежелательные файлы и использовать плагины без необходимости постоянно вводить параметры в командной строке.



